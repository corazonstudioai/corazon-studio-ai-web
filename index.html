<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Coraz√≥n Studio AI</title>
<style>
body{font-family:Arial;background:#0b1220;color:#fff;margin:0;padding:16px}
.card{background:#121c33;padding:16px;border-radius:16px;margin-bottom:16px}
textarea,select,input,button{width:100%;padding:12px;border-radius:10px;border:none;margin-top:8px}
button{background:#2b6bff;color:white;font-weight:bold}
video{width:100%;margin-top:10px;border-radius:12px}
</style>
</head>
<body>

<div class="card">
<h2>‚öôÔ∏è Backend</h2>
<input id="backend" placeholder="https://corazon-studio-ai-backend-3.onrender.com"/>
<button onclick="save()">Guardar</button>
<button onclick="test()">Probar</button>
<pre id="status"></pre>
</div>

<div class="card">
<h2>üí¨ Chat</h2>
<textarea id="chatText"></textarea>
<button onclick="chat()">Enviar</button>
<pre id="chatOut"></pre>
</div>

<div class="card">
<h2>üñºÔ∏è Imagen</h2>
<textarea id="imgText"></textarea>
<button onclick="image()">Generar</button>
<img id="img" style="width:100%;display:none"/>
</div>

<div class="card">
<h2>üé¨ Video</h2>
<select id="mode">
<option value="reels">Modo A: Reels (MP4)</option>
<option value="runway">Modo B: Runway</option>
<option value="pika">Modo C: Pika</option>
</select>
<textarea id="videoText"></textarea>
<input id="duration" type="number" value="6"/>
<button onclick="video()">Generar Video</button>
<div id="videoOut"></div>
</div>

<script>
function getBase(){
  return localStorage.getItem("BACKEND") || "";
}
function save(){
  localStorage.setItem("BACKEND", document.getElementById("backend").value.trim());
}
async function test(){
  const r = await fetch(getBase()+"/");
  document.getElementById("status").textContent = await r.text();
}
async function chat(){
  const r = await fetch(getBase()+"/chat",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({message:chatText.value})
  });
  chatOut.textContent = (await r.json()).reply;
}
async function image(){
  const r = await fetch(getBase()+"/image",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({prompt:imgText.value})
  });
  const d = await r.json();
  img.src=d.url; img.style.display="block";
}
async function video(){
  videoOut.textContent="Generando...";
  const r = await fetch(getBase()+"/video",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      mode:mode.value,
      text:videoText.value,
      duration:Number(duration.value)
    })
  });
  const d = await r.json();
  if(d.video_url){
    videoOut.innerHTML =
      `<video controls src="${getBase()}${d.video_url}"></video>
       <a href="${getBase()}${d.video_url}" download>Descargar MP4</a>`;
  } else {
    videoOut.textContent = JSON.stringify(d,null,2);
  }
}
</script>

</body>
</html>
